let characterRepository=(function(){let characterList=[];let apiUrl='https://pokeapi.co/api/v2/pokemon/?limit=150';let modalContainer=$('#modal-container');function getAll(){return characterList}
function add(character){characterList.push(character)}
function addListItem(character){let characterDex=$('.character-list');let listCharacter=$('<li class="col-xl-3 col-lg-4 row align-item-start pokemon"></li>');let button=$('<button class="col btn btn-outline-light mb-2 mx2">');let closeButtonElement=$('<button class = "modal-close"></button>');closeButtonElement.text('Close');button.text(character.name.charAt(0).toUpperCase()+character.name.slice(1));listCharacter.append(button);characterDex.append(listCharacter);button.click(function(event){showDetails(character)})}
function loadList(){return fetch(apiUrl).then(function(response){return response.json()}).then(function(json){json.results.forEach(function(item){let character={name:item.name,detailsUrl:item.url};add(character)})}).catch(function(e){console.error(e)})}
function loadDetails(item){let url=item.detailsUrl;return fetch(url).then(function(response){return response.json()}).then(function(details){item.imageUrl=details.sprites.front_default;item.height=details.height;item.types=details.types.map((type)=>type.type.name);item.abilities=details.abilities.map((abilities)=>abilities.ability.name)}).catch(function(e){console.error(e)})}
function showDetails(character){characterRepository.loadDetails(character).then(function(){showModal(character)})}
function showModal(character){modalContainer.empty();let modal=$('<div class="modal"></div>');let closeButton=$('<button class = "modal-close" id ="closebutton" data-dismiss="modal">Close</button>')
closeButton.on('click',hideModal);let titleElement=document.createElement('h1');titleElement.innerText=character.name.charAt(0).toUpperCase()+character.name.slice(1);let contentElement=document.createElement('p');contentElement.innerText='Height: '+character.height+('\n')+'Type: '+character.types+('\n')+'Abilities: '+character.abilities;let imgElement=document.createElement('img');imgElement.src=character.imageUrl;modal.append(closeButton);modal.append(titleElement);modal.append(contentElement);modal.append(imgElement);modalContainer.append(modal);modalContainer.addClass('is-visible')}
function hideModal(){modalContainer.removeClass('is-visible')}
$(window).keydown(function(e){if(e.key==='Escape'&&modalContainer.hasClass('is-visible')){hideModal()}});modalContainer.click(function(e){let target=e.target;if(target===modalContainer){hideModal()}});return{getAll:getAll,add:add,addListItem:addListItem,loadList:loadList,loadDetails:loadDetails,showDetails:showDetails}})();characterRepository.loadList().then(function(){characterRepository.getAll().map(function(character){characterRepository.addListItem(character)})});let filter=document.querySelector('#mySearch');let noResults=document.createElement('h3');noResults.innerText="No PokÃ©mon found.";noResults.style.color='white';filter.addEventListener('input',()=>{let list=document.querySelector('.character-list');let value=filter.value.toLowerCase();listItems=list.getElementsByTagName('li');let isPokemonFound=!1;for(let i=0;i<listItems.length;i++){let button=listItems[i].getElementsByTagName('button')[0];let pokemon=button.textContent||button.innerText;if(pokemon.toLowerCase().indexOf(value)>-1){listItems[i].style.display="";isPokemonFound=!0}else{listItems[i].style.display="none"}}
if(!isPokemonFound){list.appendChild(noResults)}
if(list.contains(noResults)&&isPokemonFound){list.removeChild(noResults)}})